<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Firebase Live Video Sharing</title>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/simple-peer@latest/dist/simple-peer.min.js"></script>
</head>
<body>

<video id="local-video" width="640" height="480" autoplay></video>
<video id="remote-video" width="640" height="480" autoplay></video>

<style>
#local-video, #remote-video{
  display: inline-block;
  border: 2px solid black;
}
</style>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyDvCoFrxTR4ytDVLBpiMArHzdc_AiYBkMU",
  authDomain: "hyper-e2e9f.firebaseapp.com",
  databaseURL: "https://hyper-e2e9f-default-rtdb.firebaseio.com",
  projectId: "hyper-e2e9f",
  storageBucket: "hyper-e2e9f.firebasestorage.app",
  messagingSenderId: "995423221322",
  appId: "1:995423221322:web:20be1f7e6f4827134798b3"
});

const localVideo = document.getElementById('local-video');
const remoteVideo = document.getElementById('remote-video');

navigator.mediaDevices.getUserMedia({video: true, audio: true})
  .then(stream => {
    localVideo.srcObject = stream;
    return new SimplePeer({
      initiator: location.hash === '#init',
      stream: stream,
      referrer: 'https://hyper-e2e9f.firebaseapp.com',
      config: { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] }
    });
  })
  .then(peer => {
    peer.on('stream', stream => {
      remoteVideo.srcObject = stream;
    });
  })
  .catch(error => console.error('Error:', error));

</script>

</body>
</html>

